<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Church Membership</title>
<style>
body { font-family: Arial; background: #1a1a1a; margin: 0; padding: 20px; }
.box { max-width: 500px; margin: 50px auto; background: white; padding: 30px; border-radius: 8px; }
h2 { color: #1a472a; text-align: center; margin-bottom: 20px; }
.form-group { margin: 15px 0; }
label { display: block; font-weight: bold; margin-bottom: 5px; }
input { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; }
button { width: 100%; padding: 10px; margin-top: 10px; background: #1a472a; color: white; border: none; border-radius: 4px; cursor: pointer; }
button:hover { background: #2d6a3f; }
.hidden { display: none; }
.app { max-width: 1000px; margin: 0 auto; background: white; padding: 20px; border-radius: 8px; }
.header { display: flex; justify-content: space-between; align-items: center; border-bottom: 2px solid #1a472a; padding-bottom: 20px; margin-bottom: 20px; }
.card { background: #f9f9f9; padding: 20px; margin: 20px 0; border-radius: 4px; }
.member { display: flex; justify-content: space-between; padding: 10px; background: white; margin: 5px 0; border-left: 4px solid #1a472a; }
.stat { display: inline-block; width: 30%; text-align: center; padding: 15px; background: #f0f0f0; margin: 1%; border-radius: 4px; }
.stat-num { font-size: 24px; font-weight: bold; color: #1a472a; }
.btn-export { background: #28a745; }
.btn-export:hover { background: #218838; }
</style>
</head>
<body>

<div id="login" class="box">
<h2>Church Membership System</h2>

<div id="loginMode">
<div class="form-group">
<label>Email</label>
<input type="email" id="email1" placeholder="pastor@church.com">
</div>
<div class="form-group">
<label>Password</label>
<input type="password" id="pass1" placeholder="Password">
</div>
<button onclick="login()">Login</button>
<button onclick="toSignup()" style="background: #666;">Sign Up</button>
</div>

<div id="signupMode" class="hidden">
<div class="form-group">
<label>Church Name</label>
<input type="text" id="church" placeholder="Your Church">
</div>
<div class="form-group">
<label>Email</label>
<input type="email" id="email2" placeholder="pastor@church.com">
</div>
<div class="form-group">
<label>Password</label>
<input type="password" id="pass2" placeholder="Password">
</div>
<button onclick="signup()">Create Account</button>
<button onclick="toLogin()" style="background: #666;">Back</button>
</div>

</div>

<div id="app" class="app hidden">
<div class="header">
<h1>Church Members</h1>
<div>
<span>Church: <strong id="cname">My Church</strong></span>
<button onclick="logout()" style="width: 120px; margin-left: 20px;">Logout</button>
</div>
</div>

<div>
<div class="stat">
<div class="stat-num" id="stat1">0</div>
<div>Members</div>
</div>
<div class="stat">
<div class="stat-num" id="stat2">0</div>
<div>Visitors</div>
</div>
<div class="stat">
<div class="stat-num" id="stat3">0</div>
<div>Leaders</div>
</div>
</div>

<div class="card">
<h3>Add Member</h3>
<div class="form-group">
<label>First Name</label>
<input type="text" id="fname" placeholder="John">
</div>
<div class="form-group">
<label>Last Name</label>
<input type="text" id="lname" placeholder="Smith">
</div>
<div class="form-group">
<label>Email</label>
<input type="email" id="memail" placeholder="john@email.com">
</div>
<div class="form-group">
<label>Phone</label>
<input type="tel" id="phone" placeholder="123-456-7890">
</div>
<button onclick="addMember()">Add Member</button>
</div>

<div class="card">
<h3>Members</h3>
<input type="text" id="search" placeholder="Search..." style="width: 100%; padding: 8px; margin-bottom: 10px;">
<button onclick="exportToCSV()" class="btn-export">Download CSV</button>
<div id="list"></div>
</div>

</div>

<script>
var members = [];
var church = "My Church";

function login() {
  var e = document.getElementById("email1").value;
  var p = document.getElementById("pass1").value;
  if(e && p) {
    church = "Church - " + e.split("@")[0];
    showApp();
  } else {
    alert("Enter email and password");
  }
}

function signup() {
  var c = document.getElementById("church").value;
  var e = document.getElementById("email2").value;
  var p = document.getElementById("pass2").value;
  if(c && e && p) {
    church = c;
    showApp();
  } else {
    alert("Fill all fields");
  }
}

function toSignup() {
  document.getElementById("loginMode").style.display = "none";
  document.getElementById("signupMode").style.display = "block";
}

function toLogin() {
  document.getElementById("loginMode").style.display = "block";
  document.getElementById("signupMode").style.display = "none";
}

function showApp() {
  document.getElementById("login").style.display = "none";
  document.getElementById("app").style.display = "block";
  document.getElementById("cname").textContent = church;
  updateList();
}

function logout() {
  members = [];
  document.getElementById("login").style.display = "block";
  document.getElementById("app").style.display = "none";
  document.getElementById("loginMode").style.display = "block";
  document.getElementById("signupMode").style.display = "none";
  document.getElementById("email1").value = "";
  document.getElementById("pass1").value = "";
}

function addMember() {
  var fn = document.getElementById("fname").value;
  var ln = document.getElementById("lname").value;
  var e = document.getElementById("memail").value;
  var ph = document.getElementById("phone").value;
  
  if(!fn || !ln) {
    alert("Enter name");
    return;
  }
  
  members.push({
    id: Date.now(),
    fname: fn,
    lname: ln,
    email: e,
    phone: ph
  });
  
  document.getElementById("fname").value = "";
  document.getElementById("lname").value = "";
  document.getElementById("memail").value = "";
  document.getElementById("phone").value = "";
  
  updateList();
  updateStats();
  alert("Member added");
}

function deleteMember(id) {
  if(confirm("Delete?")) {
    members = members.filter(function(m) { return m.id != id; });
    updateList();
    updateStats();
  }
}

function updateList() {
  var s = document.getElementById("search").value.toLowerCase();
  var f = members.filter(function(m) {
    return m.fname.toLowerCase().indexOf(s) > -1 || m.lname.toLowerCase().indexOf(s) > -1;
  });
  
  var html = "";
  for(var i = 0; i < f.length; i++) {
    var m = f[i];
    html += "<div class='member'><div><strong>" + m.fname + " " + m.lname + "</strong><br>" + m.email + " | " + m.phone + "</div>";
    html += "<button style='width:80px;' onclick='deleteMember(" + m.id + ")'>Delete</button></div>";
  }
  
  if(html === "") html = "<p>No members</p>";
  document.getElementById("list").innerHTML = html;
}

function updateStats() {
  document.getElementById("stat1").textContent = members.length;
  document.getElementById("stat2").textContent = Math.floor(members.length * 0.3);
  document.getElementById("stat3").textContent = Math.floor(members.length * 0.1);
}

document.getElementById("search").addEventListener("keyup", updateList);

function exportToCSV() {
  if(members.length === 0) {
    alert("No members to export");
    return;
  }
  
  try {
    var csv = "First Name,Last Name,Email,Phone\n";
    for(var i = 0; i < members.length; i++) {
      var m = members[i];
      csv += '"' + m.fname + '","' + m.lname + '","' + m.email + '","' + m.phone + '"\n';
    }
    
    var element = document.createElement("a");
    element.setAttribute("href", "data:text/csv;charset=utf-8," + encodeURIComponent(csv));
    element.setAttribute("download", "church_members.csv");
    element.style.display = "none";
    document.body.appendChild(element);
    element.click();
    document.body.removeChild(element);
    alert("File downloaded!");
  } catch(err) {
    alert("Export error: " + err);
  }
}
</script>

</body>
</html>
